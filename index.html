<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="./img/logo.png">
  <title>Allez Cycling Tour</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #16152B 0%, #1a1940 100%);
      color: #ffffff;
      min-height: 100%;
      overflow-x: hidden;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      width: 100%;
      min-height: 100%;
      background: #16152B;
    }

    /* Loading Screen */
    .loading-screen {
      display: none;
      width: 100%;
      min-height: 100%;
      justify-content: center;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9999;
    }

    .loading-screen.active {
      display: flex;
    }

    .loading-content {
      text-align: center;
      animation: fadeInScale 0.8s ease-out;
    }

    .loading-logo {
      width: 25%;
      aspect-ratio: 1/1;
      margin: 0 auto 20px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
    }

    .loading-spinner-container {
      margin: 30px auto;
      animation: fadeInUp 0.8s ease-out 0.4s backwards;
    }

    .loading-spinner-circle {
      width: 60px;
      height: 60px;
      margin: 0 auto;
      border: 4px solid rgba(199, 182, 120, 0.2);
      border-radius: 50%;
      border-top-color: #C7B678;
      animation: spin 1s linear infinite;
    }

    .loading-text {
      color: #a0a0a0;
      font-size: 16px;
      margin-top: 20px;
      animation: fadeInUp 0.8s ease-out 0.6s backwards, pulse 2s ease-in-out 1s infinite;
    }

    /* Auth Screens */
    .auth-screen {
      display: none;
      width: 100%;
      min-height: 100%;
      padding: 20px;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #16152B 0%, #1a1940 100%);
    }

    .auth-screen.active {
      display: flex;
    }

    .auth-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 24px;
      padding: 40px 30px;
      width: 100%;
      max-width: 420px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(199, 182, 120, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .auth-logo {
      text-align: center;
      margin-bottom: 30px;
    }

    .auth-logo-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 15px;

      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
    }

    .auth-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 10px;
      color: #ffffff;
      text-align: center;
    }

    .auth-subtitle {
      color: #a0a0a0;
      text-align: center;
      margin-bottom: 30px;
      font-size: 15px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      color: #C7B678;
      font-weight: 500;
      font-size: 14px;
    }

    .form-input {
      width: 100%;
      padding: 14px 16px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(199, 182, 120, 0.3);
      border-radius: 12px;
      color: #ffffff;
      font-size: 15px;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: #C7B678;
      background: rgba(255, 255, 255, 0.12);
    }

    .form-input::placeholder {
      color: #666666;
    }

    .btn-primary {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      color: #16152B;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 10px;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(199, 182, 120, 0.4);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .auth-switch {
      text-align: center;
      margin-top: 25px;
      color: #a0a0a0;
      font-size: 14px;
    }

    .auth-link {
      color: #C7B678;
      text-decoration: none;
      font-weight: 600;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .auth-link:hover {
      color: #d4c591;
    }

    .error-message {
      background: rgba(220, 53, 69, 0.2);
      color: #ff6b7a;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      border: 1px solid rgba(220, 53, 69, 0.3);
      display: none;
    }

    .error-message.show {
      display: block;
    }

    /* Main App */
    .main-app {
      display: none;
      width: 100%;
      min-height: 100%;
    }

    .main-app.active {
      display: block;
    }

    .header {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-bottom: 1px solid rgba(199, 182, 120, 0.2);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .app-logo {
      font-size: 22px;
      font-weight: 700;
      color: #C7B678;
    }

    .btn-logout {
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.1);
      color: #ffffff;
      border: 1px solid rgba(199, 182, 120, 0.3);
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-logout:hover {
      background: rgba(199, 182, 120, 0.2);
      border-color: #C7B678;
    }

    .content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Search Bar */
    .search-container {
      margin-bottom: 30px;
      position: relative;
    }

    .search-box {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }

    .search-icon {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 20px;
      z-index: 1;
      pointer-events: none;
    }

    .search-input {
      width: 100%;
      padding: 16px 50px 16px 55px;
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(199, 182, 120, 0.3);
      border-radius: 16px;
      color: #ffffff;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: #C7B678;
      background: rgba(255, 255, 255, 0.12);
      box-shadow: 0 4px 20px rgba(199, 182, 120, 0.2);
    }

    .search-input::placeholder {
      color: #666666;
    }

    .search-clear {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      width: 32px;
      height: 32px;
      background: rgba(199, 182, 120, 0.2);
      border: none;
      border-radius: 50%;
      color: #C7B678;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      line-height: 1;
    }

    .search-clear:hover {
      background: rgba(199, 182, 120, 0.3);
      transform: translateY(-50%) scale(1.1);
    }

    .search-results {
      position: absolute;
      top: calc(100% + 10px);
      left: 0;
      right: 0;
      max-width: 600px;
      margin: 0 auto;
      background: rgba(22, 21, 43, 0.98);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(199, 182, 120, 0.3);
      border-radius: 16px;
      max-height: 400px;
      overflow-y: auto;
      display: none;
      z-index: 100;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .search-results.active {
      display: block;
      animation: fadeInUp 0.3s ease-out;
    }

    .search-result-item {
      padding: 15px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .search-result-item:last-child {
      border-bottom: none;
    }

    .search-result-item:hover {
      background: rgba(199, 182, 120, 0.1);
      padding-left: 25px;
    }

    .search-result-icon {
      font-size: 28px;
      flex-shrink: 0;
    }

    .search-result-content {
      flex: 1;
    }

    .search-result-type {
      color: #C7B678;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 3px;
    }

    .search-result-title {
      color: #ffffff;
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 3px;
    }

    .search-result-subtitle {
      color: #a0a0a0;
      font-size: 13px;
    }

    .search-no-results {
      padding: 30px 20px;
      text-align: center;
      color: #a0a0a0;
    }

    .search-no-results-icon {
      font-size: 48px;
      margin-bottom: 10px;
      opacity: 0.5;
    }

    /* User Profile */
    .user-profile {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      gap: 20px;
      border: 1px solid rgba(199, 182, 120, 0.2);
    }

    .user-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      font-weight: 700;
      color: #16152B;
      flex-shrink: 0;
    }

    .user-info {
      flex: 1;
    }

    .user-welcome {
      color: #a0a0a0;
      font-size: 14px;
      margin-bottom: 5px;
    }

    .user-name {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
    }

    /* Races Carousel */
    .section-title {
      font-size: 22px;
      font-weight: 700;
      color: #C7B678;
      margin-bottom: 20px;
      padding-left: 5px;
    }

    .carousel-container {
      position: relative;
      margin-bottom: 40px;
      overflow: hidden;
    }

    .carousel-wrapper {
      overflow-x: auto;
      overflow-y: hidden;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .carousel-wrapper::-webkit-scrollbar {
      display: none;
    }

    .carousel-track {
      display: flex;
      gap: 15px;
      padding: 5px;
    }

    .race-card {
      flex: 0 0 280px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(199, 182, 120, 0.2);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .race-card:hover {
      transform: translateY(-5px);
      border-color: #C7B678;
      box-shadow: 0 8px 24px rgba(199, 182, 120, 0.3);
    }

    .race-image {
      width: 100%;
      height: 160px;
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
    }

    .race-content {
      padding: 20px;
    }

    .race-date {
      color: #C7B678;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .race-title {
      font-size: 18px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
    }

    .race-location {
      color: #a0a0a0;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .carousel-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      background: rgba(199, 182, 120, 0.9);
      border: none;
      border-radius: 50%;
      color: #16152B;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .carousel-nav:hover {
      background: #C7B678;
      transform: translateY(-50%) scale(1.1);
    }

    .carousel-nav.prev {
      left: 10px;
    }

    .carousel-nav.next {
      right: 10px;
    }

    /* News Section */
    .news-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .news-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(199, 182, 120, 0.2);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .news-card:hover {
      transform: translateY(-5px);
      border-color: #C7B678;
      box-shadow: 0 8px 24px rgba(199, 182, 120, 0.3);
    }

    .news-image {
      width: 100%;
      height: 180px;
      background: linear-gradient(135deg, #2a2850 0%, #16152B 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 56px;
    }

    .news-content {
      padding: 20px;
    }

    .news-category {
      color: #C7B678;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .news-title {
      font-size: 18px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 10px;
      line-height: 1.4;
    }

    .news-excerpt {
      color: #a0a0a0;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .news-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #666666;
      font-size: 12px;
    }

    /* Detail View */
    .detail-view {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #16152B;
      z-index: 200;
      overflow-y: auto;
    }

    .detail-view.active {
      display: block;
    }

    .detail-header {
      position: sticky;
      top: 0;
      background: rgba(22, 21, 43, 0.95);
      backdrop-filter: blur(10px);
      padding: 20px;
      border-bottom: 1px solid rgba(199, 182, 120, 0.2);
      z-index: 10;
    }

    .detail-header-content {
      max-width: 1000px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .btn-back {
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(199, 182, 120, 0.3);
      border-radius: 50%;
      color: #ffffff;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .btn-back:hover {
      background: rgba(199, 182, 120, 0.2);
      border-color: #C7B678;
    }

    .detail-title-text {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
    }

    .detail-content {
      max-width: 1000px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    .detail-hero {
      width: 100%;
      height: 300px;
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
      margin-bottom: 30px;
    }

    .detail-meta {
      display: flex;
      gap: 30px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .meta-icon {
      font-size: 20px;
    }

    .meta-text {
      color: #a0a0a0;
      font-size: 15px;
    }

    .meta-value {
      color: #ffffff;
      font-weight: 600;
    }

    .detail-description {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 30px;
      border: 1px solid rgba(199, 182, 120, 0.2);
    }

    .detail-description h3 {
      color: #C7B678;
      margin-bottom: 15px;
      font-size: 20px;
    }

    .detail-description p {
      color: #cccccc;
      line-height: 1.8;
      font-size: 15px;
    }

    .cta-section {
      text-align: center;
      padding: 40px 20px;
      background: rgba(199, 182, 120, 0.1);
      border-radius: 20px;
      margin-bottom: 30px;
      border: 2px solid rgba(199, 182, 120, 0.3);
    }

    .cta-title {
      font-size: 28px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 15px;
    }

    .cta-subtitle {
      color: #a0a0a0;
      font-size: 16px;
      margin-bottom: 30px;
    }

    .cta-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn-cta {
      padding: 16px 32px;
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      color: #16152B;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(199, 182, 120, 0.4);
    }

    .btn-cta-secondary {
      padding: 16px 32px;
      background: rgba(255, 255, 255, 0.1);
      color: #C7B678;
      border: 2px solid #C7B678;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-cta-secondary:hover {
      background: rgba(199, 182, 120, 0.2);
      transform: translateY(-2px);
    }

    /* Packages View */
    .packages-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 25px;
    }

    .package-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      overflow: hidden;
      border: 2px solid rgba(199, 182, 120, 0.2);
      transition: all 0.3s ease;
    }

    .package-card:hover {
      border-color: #C7B678;
      transform: translateY(-5px);
      box-shadow: 0 12px 32px rgba(199, 182, 120, 0.3);
    }

    .package-badge {
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      color: #16152B;
      padding: 8px 20px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      text-align: center;
    }

    .package-body {
      padding: 25px;
    }

    .package-name {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 10px;
    }

    .package-price {
      font-size: 36px;
      font-weight: 700;
      color: #C7B678;
      margin-bottom: 5px;
    }

    .package-price-note {
      color: #a0a0a0;
      font-size: 13px;
      margin-bottom: 20px;
    }

    .package-features {
      list-style: none;
      padding: 0;
      margin: 0 0 25px 0;
    }

    .package-features li {
      padding: 12px 0;
      color: #cccccc;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .package-features li:last-child {
      border-bottom: none;
    }

    .feature-icon {
      color: #C7B678;
      font-size: 16px;
    }

    .btn-package {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #C7B678 0%, #d4c591 100%);
      color: #16152B;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-package:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(199, 182, 120, 0.5);
    }

    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #16152B;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }

    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes glow {
      0%, 100% {
        box-shadow: 0 0 20px rgba(199, 182, 120, 0.3);
      }
      50% {
        box-shadow: 0 0 40px rgba(199, 182, 120, 0.6);
      }
    }

    .auth-card {
      animation: fadeInScale 0.6s ease-out;
    }

    .auth-logo-icon {
      animation: float 3s ease-in-out infinite;
    }

    .form-group {
      animation: fadeInUp 0.5s ease-out backwards;
    }

    .form-group:nth-child(1) {
      animation-delay: 0.1s;
    }

    .form-group:nth-child(2) {
      animation-delay: 0.2s;
    }

    .form-group:nth-child(3) {
      animation-delay: 0.3s;
    }

    .btn-primary {
      position: relative;
      overflow: hidden;
      animation: fadeInUp 0.5s ease-out 0.4s backwards;
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }

    .btn-primary:hover::before {
      left: 100%;
    }

    .user-profile {
      animation: fadeInUp 0.6s ease-out;
    }

    .user-avatar {
      animation: fadeInScale 0.8s ease-out 0.2s backwards, pulse 2s ease-in-out 1s infinite;
    }

    .user-info {
      animation: slideInRight 0.6s ease-out 0.3s backwards;
    }

    .section-title {
      animation: slideInLeft 0.6s ease-out;
      position: relative;
      overflow: hidden;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, #C7B678, transparent);
      animation: shimmer 2s linear infinite;
      background-size: 1000px 100%;
    }

    .race-card {
      animation: fadeInUp 0.6s ease-out backwards;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .race-card:nth-child(1) { animation-delay: 0.1s; }
    .race-card:nth-child(2) { animation-delay: 0.2s; }
    .race-card:nth-child(3) { animation-delay: 0.3s; }
    .race-card:nth-child(4) { animation-delay: 0.4s; }
    .race-card:nth-child(5) { animation-delay: 0.5s; }

    .race-card:hover {
      transform: translateY(-8px) scale(1.03);
    }

    .race-image {
      transition: transform 0.4s ease;
    }

    .race-card:hover .race-image {
      transform: scale(1.1) rotate(5deg);
    }

    .news-card {
      animation: fadeInScale 0.6s ease-out backwards;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .news-card:nth-child(1) { animation-delay: 0.1s; }
    .news-card:nth-child(2) { animation-delay: 0.2s; }
    .news-card:nth-child(3) { animation-delay: 0.3s; }
    .news-card:nth-child(4) { animation-delay: 0.4s; }
    .news-card:nth-child(5) { animation-delay: 0.5s; }
    .news-card:nth-child(6) { animation-delay: 0.6s; }

    .news-card:hover {
      transform: translateY(-8px) rotate(1deg);
    }

    .news-image {
      transition: transform 0.5s ease;
    }

    .news-card:hover .news-image {
      transform: scale(1.15);
    }

    .carousel-nav {
      animation: fadeInScale 0.8s ease-out 0.5s backwards;
    }

    .carousel-nav:active {
      transform: translateY(-50%) scale(0.9);
    }

    .detail-view.active .detail-hero {
      animation: fadeInScale 0.8s ease-out;
    }

    .detail-view.active .detail-meta {
      animation: fadeInUp 0.6s ease-out 0.2s backwards;
    }

    .detail-view.active .detail-description {
      animation: fadeInUp 0.6s ease-out 0.3s backwards;
    }

    .detail-view.active .cta-section {
      animation: fadeInUp 0.8s ease-out 0.4s backwards, glow 3s ease-in-out 1s infinite;
    }

    .meta-item {
      animation: slideInRight 0.5s ease-out backwards;
    }

    .meta-item:nth-child(1) { animation-delay: 0.3s; }
    .meta-item:nth-child(2) { animation-delay: 0.4s; }
    .meta-item:nth-child(3) { animation-delay: 0.5s; }

    .btn-cta, .btn-cta-secondary {
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .btn-cta::before, .btn-cta-secondary::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }

    .btn-cta:hover::before, .btn-cta-secondary:hover::before {
      width: 300px;
      height: 300px;
    }

    .btn-cta:hover {
      transform: translateY(-3px) scale(1.05);
    }

    .btn-cta-secondary:hover {
      transform: translateY(-3px) scale(1.05);
    }

    .package-card {
      animation: fadeInUp 0.6s ease-out backwards;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .package-card:nth-child(1) { animation-delay: 0.1s; }
    .package-card:nth-child(2) { animation-delay: 0.2s; }
    .package-card:nth-child(3) { animation-delay: 0.3s; }

    .package-card:hover {
      transform: translateY(-10px) scale(1.02);
    }

    .package-badge {
      position: relative;
      overflow: hidden;
    }

    .package-badge::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 3s ease-in-out infinite;
    }

    .btn-package {
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .btn-package::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(22, 21, 43, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.5s ease, height 0.5s ease;
    }

    .btn-package:hover::before {
      width: 400px;
      height: 400px;
    }

    .btn-package:hover {
      transform: translateY(-3px) scale(1.05);
    }

    .header {
      animation: slideInLeft 0.6s ease-out;
    }

    .btn-back {
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .btn-back:active {
      transform: scale(0.9) rotate(-180deg);
    }

    .error-message.show {
      animation: fadeInUp 0.4s ease-out;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .news-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 15px;
      }

      .packages-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
      }

      .detail-meta {
        gap: 20px;
      }
    }

    @media (max-width: 768px) {
      .search-container {
        margin-bottom: 25px;
      }

      .search-input {
        padding: 14px 45px 14px 50px;
        font-size: 15px;
      }

      .search-icon {
        font-size: 18px;
        left: 18px;
      }

      .search-clear {
        width: 28px;
        height: 28px;
        font-size: 20px;
      }

      .search-results {
        max-height: 350px;
      }

      .search-result-item {
        padding: 12px 15px;
      }

      .search-result-icon {
        font-size: 24px;
      }

      .search-result-title {
        font-size: 14px;
      }

      .search-result-subtitle {
        font-size: 12px;
      }

      .auth-card {
        padding: 30px 20px;
        margin: 10px;
      }

      .auth-title {
        font-size: 24px;
      }

      .auth-logo-icon {
        width: 70px;
        height: 70px;
        font-size: 36px;
      }

      .header {
        padding: 15px;
      }

      .header-content {
        flex-wrap: wrap;
        gap: 10px;
      }

      .app-logo {
        font-size: 18px;
      }

      .btn-logout {
        padding: 8px 16px;
        font-size: 13px;
      }

      .content {
        padding: 15px;
      }

      .user-profile {
        flex-direction: row;
        padding: 20px;
        gap: 15px;
      }

      .user-avatar {
        width: 60px;
        height: 60px;
        font-size: 24px;
      }

      .user-name {
        font-size: 20px;
      }

      .user-welcome {
        font-size: 13px;
      }

      .section-title {
        font-size: 20px;
        margin-bottom: 15px;
      }

      .race-card {
        flex: 0 0 260px;
      }

      .race-image {
        height: 140px;
        font-size: 40px;
      }

      .race-content {
        padding: 15px;
      }

      .race-title {
        font-size: 16px;
      }

      .news-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .news-image {
        height: 160px;
        font-size: 48px;
      }

      .news-content {
        padding: 18px;
      }

      .news-title {
        font-size: 17px;
      }

      .detail-header {
        padding: 15px;
      }

      .detail-header-content {
        gap: 15px;
      }

      .btn-back {
        width: 36px;
        height: 36px;
        font-size: 18px;
      }

      .detail-title-text {
        font-size: 18px;
      }

      .detail-content {
        padding: 20px 15px;
      }

      .detail-hero {
        height: 220px;
        font-size: 64px;
        border-radius: 16px;
        margin-bottom: 25px;
      }

      .detail-meta {
        flex-direction: column;
        gap: 15px;
        margin-bottom: 25px;
      }

      .meta-item {
        width: 100%;
      }

      .detail-description {
        padding: 20px;
        margin-bottom: 25px;
      }

      .detail-description h3 {
        font-size: 18px;
      }

      .detail-description p {
        font-size: 14px;
      }

      .cta-section {
        padding: 30px 20px;
        margin-bottom: 25px;
      }

      .cta-title {
        font-size: 24px;
      }

      .cta-subtitle {
        font-size: 15px;
      }

      .cta-buttons {
        flex-direction: column;
        width: 100%;
      }

      .btn-cta,
      .btn-cta-secondary {
        width: 100%;
        padding: 14px 24px;
        font-size: 15px;
      }

      .packages-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .package-body {
        padding: 20px;
      }

      .package-name {
        font-size: 22px;
      }

      .package-price {
        font-size: 32px;
      }

      .carousel-nav {
        width: 36px;
        height: 36px;
        font-size: 18px;
      }

      .carousel-nav.prev {
        left: 5px;
      }

      .carousel-nav.next {
        right: 5px;
      }
    }

    @media (max-width: 480px) {
      .search-container {
        margin-bottom: 20px;
      }

      .search-input {
        padding: 12px 42px 12px 45px;
        font-size: 14px;
        border-radius: 12px;
      }

      .search-icon {
        font-size: 16px;
        left: 16px;
      }

      .search-clear {
        width: 26px;
        height: 26px;
        font-size: 18px;
      }

      .search-results {
        max-height: 300px;
        border-radius: 12px;
      }

      .search-result-item {
        padding: 10px 12px;
        gap: 12px;
      }

      .search-result-icon {
        font-size: 22px;
      }

      .search-result-type {
        font-size: 10px;
      }

      .search-result-title {
        font-size: 13px;
      }

      .search-result-subtitle {
        font-size: 11px;
      }

      .search-no-results {
        padding: 25px 15px;
      }

      .search-no-results-icon {
        font-size: 40px;
      }

      .auth-card {
        padding: 25px 15px;
      }

      .auth-title {
        font-size: 22px;
      }

      .auth-subtitle {
        font-size: 14px;
      }

      .form-input {
        padding: 12px 14px;
        font-size: 14px;
      }

      .btn-primary {
        padding: 14px;
        font-size: 15px;
      }

      .app-logo {
        font-size: 16px;
      }

      .user-profile {
        flex-direction: column;
        text-align: center;
        padding: 18px;
      }

      .user-avatar {
        width: 55px;
        height: 55px;
        font-size: 22px;
      }

      .user-name {
        font-size: 18px;
      }

      .section-title {
        font-size: 18px;
      }

      .race-card {
        flex: 0 0 240px;
      }

      .race-content {
        padding: 12px;
      }

      .race-title {
        font-size: 15px;
      }

      .race-location {
        font-size: 13px;
      }

      .news-image {
        height: 140px;
        font-size: 42px;
      }

      .news-content {
        padding: 15px;
      }

      .news-title {
        font-size: 16px;
      }

      .news-excerpt {
        font-size: 13px;
      }

      .detail-hero {
        height: 180px;
        font-size: 54px;
      }

      .detail-title-text {
        font-size: 16px;
      }

      .cta-title {
        font-size: 22px;
      }

      .cta-subtitle {
        font-size: 14px;
        margin-bottom: 25px;
      }

      .package-name {
        font-size: 20px;
      }

      .package-price {
        font-size: 28px;
      }

      .carousel-nav {
        display: none;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container"><!-- Loading Screen -->
   <div class="loading-screen active" id="loadingScreen">
    <div class="loading-content">
     <div class="loading-logo">
      <img src="img/logo.png">
     </div>
     <div class="loading-spinner-container">
      <div class="loading-spinner-circle"></div>
     </div>
     <div class="loading-text">
      Loading your experience...
     </div>
    </div>
   </div><!-- Login Screen -->
   <div class="auth-screen" id="loginScreen">
    <div class="auth-card">
     <div class="auth-logo">
      <div class="auth-logo-icon">
       <img src="img/logo.png">
      </div>
     </div>
     <h1 class="auth-title" id="authAppTitle">Allez Cycling Tour</h1>
     <p class="auth-subtitle">Sign in to continue your adventure</p>
     <div class="error-message" id="loginError"></div>
     <form id="loginForm">
      <div class="form-group"><label class="form-label" for="loginEmail">Email Address</label> <input type="email" id="loginEmail" class="form-input" placeholder="you@email.com" required>
      </div>
      <div class="form-group"><label class="form-label" for="loginPassword">Password</label> <input type="password" id="loginPassword" class="form-input" placeholder="ÔøΩÔøΩ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
      </div><button type="submit" class="btn-primary" id="loginButton"> Sign In </button>
     </form>
     <div class="auth-switch">
      Don't have an account? <a class="auth-link" id="showSignup">Create account</a>
     </div>
    </div>
   </div><!-- Signup Screen -->
   <div class="auth-screen" id="signupScreen">
    <div class="auth-card">
     <div class="auth-logo">
      <div class="auth-logo-icon">
       <img src="img/logo.png">
      </div>
     </div>
     <h1 class="auth-title" id="signupAppTitle">Tour de France M√©xico</h1>
     <p class="auth-subtitle">√önete a la comunidad de ciclismo m√°s apasionante</p>
     <div class="error-message" id="signupError"></div>
     <form id="signupForm">
      <div class="form-group"><label class="form-label" for="signupName">Nombre Completo</label> <input type="text" id="signupName" class="form-input" placeholder="Tu nombre" required>
      </div>
      <div class="form-group"><label class="form-label" for="signupEmail">Correo Electr√≥nico</label> <input type="email" id="signupEmail" class="form-input" placeholder="tu@email.com" required>
      </div>
      <div class="form-group"><label class="form-label" for="signupPassword">ContraseÔøΩÔøΩa</label> <input type="password" id="signupPassword" class="form-input" placeholder="M√≠nimo 6 caracteres" required minlength="6">
      </div><button type="submit" class="btn-primary" id="signupButton"> Crear Cuenta </button>
     </form>
     <div class="auth-switch">
      ¬øYa tienes cuenta? <a class="auth-link" id="showLogin">Iniciar sesi√≥n</a>
     </div>
    </div>
   </div><!-- Main App -->
   <div class="main-app" id="mainApp">
    <header class="header">
     <div class="header-content">
      <div class="app-logo" id="headerAppTitle">
       Allez Cycling Tour
      </div><button class="btn-logout" id="logoutButton">Sign Out</button>
     </div>
    </header>
    <main class="content" id="homeView"><!-- Search Bar -->
     <div class="search-container">
      <div class="search-box"><span class="search-icon"><img src="https://images.vexels.com/media/users/3/140723/isolated/preview/158241d2079a635fb0cae49accb56da5-icono-de-lupa.png" style="width:5%;  filter: invert(1);"></span> <input type="text" id="searchInput" class="search-input" placeholder="Search races, news, packages..."> <button class="search-clear" id="searchClear" style="display: none;">√ó</button>
      </div>
      <div class="search-results" id="searchResults"></div>
     </div><!-- User Profile -->
     <div class="user-profile">
      <div class="user-avatar" id="userAvatar">
       U
      </div>
      <div class="user-info">
       <div class="user-welcome" id="welcomeMessage">
        Welcome back
       </div>
       <div class="user-name" id="userName">
        User
       </div>
      </div>
     </div><!-- Races Carousel -->
     <h2 class="section-title">Upcoming Races</h2>
     <div class="carousel-container"><button class="carousel-nav prev" id="carouselPrev">‚Äπ</button>
      <div class="carousel-wrapper" id="carouselWrapper">
       <div class="carousel-track" id="carouselTrack"></div>
      </div><button class="carousel-nav next" id="carouselNext">‚Ä∫</button>
     </div><!-- News Section -->
     <h2 class="section-title">Latest News</h2>
     <div class="news-grid" id="newsGrid"></div>
    </main><!-- Detail View -->
    <div class="detail-view" id="detailView">
     <div class="detail-header">
      <div class="detail-header-content"><button class="btn-back" id="backButton">‚Üê</button>
       <div class="detail-title-text" id="detailHeaderTitle"></div>
      </div>
     </div>
     <div class="detail-content" id="detailContent"></div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      app_title: "Allez Cycling Tour",
      welcome_message: "Welcome back",
      cta_primary: "Stop being a spectator",
      cta_secondary: "Live the experience!",
      background_color: "#16152B",
      surface_color: "#1a1940",
      text_color: "#ffffff",
      primary_action_color: "#C7B678",
      secondary_action_color: "#a0a0a0"
    };

    // Reference data
    const racesData = [
      { id: 1, title: "Tour de France 2024", date: "Jun 29 - Jul 21, 2024", location: "France", icon: "<img src='https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2494340/capsule_616x353.jpg?t=1764149578'/>", stage: "Stage 1-21" },
      { id: 2, title: "Paris-Nice", date: "Mar 10-17, 2024", location: "France", icon: "<img src='https://espnpressroom.com/latinamerica/files/2025/03/ESPN_D_Ciclismo_Paris-Niza_PR2025.jpg'/>", stage: "7 Stages" },
      { id: 3, title: "Crit√©rium du Dauphin√©", date: "Jun 4-11, 2024", location: "France", icon: "<img src='https://a.espncdn.com/photo/2021/0625/r872499_720x405_16-9.jpg'/>", stage: "8 Stages" },
      { id: 4, title: "Tour de Romandie", date: "Apr 30 - May 5, 2024", location: "Switzerland", icon: "<img src='https://espnpressroom.com/latinamerica/files/2025/07/ESPN_D_Ciclismo_Tour-de-France_PR2025-.jpg'/>", stage: "6 Stages" },
      { id: 5, title: "Volta a Catalunya", date: "Mar 18-24, 2024", location: "Spain", icon: "<img src='https://espnpressroom.com/latinamerica/files/2025/08/ESPN_D_Ciclismo_La-Vuelta_PR2025.jpg'/>", stage: "7 Stages" }
    ];

    const newsData = [
      { id: 1, title: "Historic Performance in Tour de France", category: "FEATURED", excerpt: "Witness incredible achievements in the general classification at this year's Tour.", date: "2 days ago", icon: "<img src='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT_ldjNK7Hnm86T0zl1IPOuhhF7_3KYMRQZGQ&s'/>" },
      { id: 2, title: "Special Tour de France 2024 Packages", category: "OFFERS", excerpt: "Discover our exclusive all-inclusive packages for the ultimate cycling experience.", date: "3 days ago", icon: "<img src='https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2736670/header.jpg?t=1717661267'/>" },
      { id: 3, title: "Training Guide: Conquer the Alps", category: "GUIDES", excerpt: "Expert tips to prepare for the most challenging mountain stages.", date: "5 days ago", icon: "<img src='https://cdn.road.cc/sites/default/files/styles/main_width/public/2020-official-tour-de-france-road-cycling-training-guide-paul-knott-pages-1.jpg'/>" },
      { id: 4, title: "VIP Experiences: Meet the Riders", category: "EVENTS", excerpt: "Exclusive paddock access and meet & greet with professional cycling teams.", date: "1 week ago", icon: "<img src='https://mummucycling.com/_next/image?url=https%3A%2F%2Fmedia.mummucycling.com%2FMUMMU_Reblex_13082024-272.jpg&w=2048&q=75'/>" },
      { id: 5, title: "Culinary Journey Through France", category: "CULTURE", excerpt: "Experience French gastronomy while following the stages of the tour.", date: "1 week ago", icon: "<img src='https://www.tamboradive.com/images/exploring-regional-delicacies-a-culinary-journey-through-france.jpg'/>" },
      { id: 6, title: "Join Our Cycling Community", category: "COMMUNITY", excerpt: "Travel with fellow cycling enthusiasts in organized group tours.", date: "2 weeks ago", icon: "<img src='https://moveupcyclingclub.com/wp-content/uploads/2024/06/Roadie-Squad-scaled-e1717599118142.jpeg'/>" }
    ];

    const packagesData = [
      {
        id: 1,
        name: "Essential",
        badge: "BASIC",
        price: "$2,500",
        note: "USD per person",
        features: [
          "‚úì Round-trip flights",
          "‚úì 10 nights accommodation",
          "‚úì Local transportation",
          "‚úì Access to 3 Tour stages",
          "‚úì English-speaking guide"
        ]
      },
      {
        id: 2,
        name: "Premium",
        badge: "POPULAR",
        price: "$4,200",
        note: "USD per person",
        features: [
          "‚úì Round-trip flights",
          "‚úì 15 nights accommodation (4‚òÖ hotels)",
          "‚úì Private transportation",
          "‚úì 6 Tour stages + Final sprint",
          "‚úì Expert bilingual guide",
          "‚úì Dinner with ex-professional cyclist"
        ]
      },
      {
        id: 3,
        name: "VIP Exclusive",
        badge: "PREMIUM",
        price: "$7,000",
        note: "USD per person",
        features: [
          "‚úì First-class round-trip flights",
          "‚úì 20 nights accommodation (5‚òÖ hotels)",
          "‚úì Luxury private transportation",
          "‚úì Access to all stages",
          "‚úì VIP paddock passes",
          "‚úì Meet & greet with teams",
          "‚úì Exclusive culinary tour",
          "‚úì Professional racing bike gift"
        ]
      }
    ];

    // App State
    let currentUser = null;
    let currentView = 'home';
    let currentDetailId = null;
    let currentDetailType = null;

    // LocalStorage keys
    const STORAGE_KEY = 'allezCyclingUser';

    // SDK Initialization
    const dataHandler = {
      onDataChanged(data) {
        // No UI updates needed for this write-only auth system
      }
    };

    async function initApp() {
      // Show loading screen
      document.getElementById('loadingScreen').classList.add('active');

      // Check for saved session
      const savedUser = localStorage.getItem(STORAGE_KEY);
      
      // Simulate loading delay
      await new Promise(resolve => setTimeout(resolve, 1500));

      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error("Failed to initialize data SDK");
        }
      }

      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            // Update all text elements
            const appTitle = config.app_title || defaultConfig.app_title;
            const welcomeMsg = config.welcome_message || defaultConfig.welcome_message;
            const ctaPrimary = config.cta_primary || defaultConfig.cta_primary;
            const ctaSecondary = config.cta_secondary || defaultConfig.cta_secondary;

            document.getElementById('authAppTitle').textContent = appTitle;
            document.getElementById('signupAppTitle').textContent = appTitle;
            document.getElementById('headerAppTitle').textContent = `üö¥ ${appTitle}`;
            document.getElementById('welcomeMessage').textContent = welcomeMsg;

            // Update colors
            const bgColor = config.background_color || defaultConfig.background_color;
            const surfaceColor = config.surface_color || defaultConfig.surface_color;
            const textColor = config.text_color || defaultConfig.text_color;
            const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;

            document.body.style.background = bgColor;
            document.querySelector('.app-container').style.background = bgColor;

            const authScreens = document.querySelectorAll('.auth-screen');
            authScreens.forEach(screen => {
              screen.style.background = `linear-gradient(135deg, ${bgColor} 0%, ${surfaceColor} 100%)`;
            });

            document.querySelectorAll('.section-title, .auth-logo-icon, .package-badge').forEach(el => {
              el.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${primaryColor}dd 100%)`;
              if (el.classList.contains('section-title')) {
                el.style.color = primaryColor;
                el.style.background = 'none';
              }
            });

            document.querySelectorAll('.auth-link, .form-label, .race-date, .news-category, .package-price').forEach(el => {
              el.style.color = primaryColor;
            });

            document.querySelectorAll('.btn-primary, .btn-cta, .btn-package').forEach(btn => {
              btn.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${primaryColor}dd 100%)`;
              btn.style.color = bgColor;
            });

            document.querySelectorAll('.user-name, .race-title, .news-title, .detail-title-text, .package-name').forEach(el => {
              el.style.color = textColor;
            });

            document.querySelectorAll('.user-welcome, .race-location, .news-excerpt, .meta-text, .package-price-note').forEach(el => {
              el.style.color = secondaryColor;
            });

            // Update CTA buttons text if detail view is showing
            const ctaButtons = document.querySelectorAll('.btn-cta');
            if (ctaButtons.length > 0) {
              ctaButtons[0].textContent = ctaPrimary;
              if (ctaButtons[1]) {
                ctaButtons[1].textContent = ctaSecondary;
              }
            }
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.background_color = value;
                    window.elementSdk.setConfig({ background_color: value });
                  }
                }
              },
              {
                get: () => config.surface_color || defaultConfig.surface_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.surface_color = value;
                    window.elementSdk.setConfig({ surface_color: value });
                  }
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.text_color = value;
                    window.elementSdk.setConfig({ text_color: value });
                  }
                }
              },
              {
                get: () => config.primary_action_color || defaultConfig.primary_action_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.primary_action_color = value;
                    window.elementSdk.setConfig({ primary_action_color: value });
                  }
                }
              },
              {
                get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.secondary_action_color = value;
                    window.elementSdk.setConfig({ secondary_action_color: value });
                  }
                }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ["app_title", config.app_title || defaultConfig.app_title],
            ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
            ["cta_primary", config.cta_primary || defaultConfig.cta_primary],
            ["cta_secondary", config.cta_secondary || defaultConfig.cta_secondary]
          ])
        });
      }

      setupEventListeners();
      renderRacesCarousel();
      renderNews();

      // Hide loading and show appropriate screen
      document.getElementById('loadingScreen').classList.remove('active');
      
      if (savedUser) {
        try {
          currentUser = JSON.parse(savedUser);
          showMainApp();
        } catch (e) {
          localStorage.removeItem(STORAGE_KEY);
          showScreen('login');
        }
      } else {
        showScreen('login');
      }
    }

    function setupEventListeners() {
      // Auth navigation
      document.getElementById('showSignup').addEventListener('click', (e) => {
        e.preventDefault();
        showScreen('signup');
      });

      document.getElementById('showLogin').addEventListener('click', (e) => {
        e.preventDefault();
        showScreen('login');
      });

      // Forms
      document.getElementById('loginForm').addEventListener('submit', handleLogin);
      document.getElementById('signupForm').addEventListener('submit', handleSignup);
      document.getElementById('logoutButton').addEventListener('click', handleLogout);

      // Carousel
      document.getElementById('carouselPrev').addEventListener('click', () => scrollCarousel('prev'));
      document.getElementById('carouselNext').addEventListener('click', () => scrollCarousel('next'));

      // Back button
      document.getElementById('backButton').addEventListener('click', showHome);

      // Search functionality
      const searchInput = document.getElementById('searchInput');
      const searchClear = document.getElementById('searchClear');
      const searchResults = document.getElementById('searchResults');

      searchInput.addEventListener('input', handleSearch);
      searchInput.addEventListener('focus', () => {
        if (searchInput.value.trim()) {
          searchResults.classList.add('active');
        }
      });

      searchClear.addEventListener('click', () => {
        searchInput.value = '';
        searchClear.style.display = 'none';
        searchResults.classList.remove('active');
        searchInput.focus();
      });

      // Close search results when clicking outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.search-container')) {
          searchResults.classList.remove('active');
        }
      });
    }

    function handleSearch(e) {
      const query = e.target.value.trim().toLowerCase();
      const searchClear = document.getElementById('searchClear');
      const searchResults = document.getElementById('searchResults');

      if (query.length === 0) {
        searchClear.style.display = 'none';
        searchResults.classList.remove('active');
        return;
      }

      searchClear.style.display = 'flex';

      // Search across all data
      const results = [];

      // Search races
      racesData.forEach(race => {
        if (race.title.toLowerCase().includes(query) || 
            race.location.toLowerCase().includes(query) ||
            race.stage.toLowerCase().includes(query)) {
          results.push({
            type: 'race',
            id: race.id,
            icon: race.icon,
            title: race.title,
            subtitle: `${race.date} ‚Ä¢ ${race.location}`,
            data: race
          });
        }
      });

      // Search news
      newsData.forEach(news => {
        if (news.title.toLowerCase().includes(query) || 
            news.excerpt.toLowerCase().includes(query) ||
            news.category.toLowerCase().includes(query)) {
          results.push({
            type: 'news',
            id: news.id,
            icon: news.icon,
            title: news.title,
            subtitle: news.category,
            data: news
          });
        }
      });

      // Search packages
      packagesData.forEach(pkg => {
        if (pkg.name.toLowerCase().includes(query) || 
            pkg.badge.toLowerCase().includes(query)) {
          results.push({
            type: 'package',
            id: pkg.id,
            icon: 'üì¶',
            title: pkg.name,
            subtitle: `${pkg.price} ‚Ä¢ ${pkg.badge}`,
            data: pkg
          });
        }
      });

      // Render results
      if (results.length > 0) {
        searchResults.innerHTML = results.map(result => `
          <div class="search-result-item" onclick="handleSearchResultClick('${result.type}', ${result.id})">
            <div class="search-result-icon">${result.icon}</div>
            <div class="search-result-content">
              <div class="search-result-type">${result.type}</div>
              <div class="search-result-title">${result.title}</div>
              <div class="search-result-subtitle">${result.subtitle}</div>
            </div>
          </div>
        `).join('');
      } else {
        searchResults.innerHTML = `
          <div class="search-no-results">
            <div class="search-no-results-icon">üîç</div>
            <div>No results found for "${query}"</div>
          </div>
        `;
      }

      searchResults.classList.add('active');
    }

    function handleSearchResultClick(type, id) {
      // Close search
      document.getElementById('searchInput').value = '';
      document.getElementById('searchClear').style.display = 'none';
      document.getElementById('searchResults').classList.remove('active');

      // Navigate to appropriate detail
      if (type === 'race') {
        showRaceDetail(id);
      } else if (type === 'news') {
        showNewsDetail(id);
      } else if (type === 'package') {
        showPackages();
        setTimeout(() => {
          const packageCard = document.querySelector(`[onclick="selectPackage(${id})"]`);
          if (packageCard) {
            packageCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            packageCard.closest('.package-card').style.animation = 'pulse 1s ease-in-out';
          }
        }, 100);
      }
    }

    function showScreen(screen) {
      document.querySelectorAll('.auth-screen').forEach(s => s.classList.remove('active'));
      if (screen === 'login') {
        document.getElementById('loginScreen').classList.add('active');
      } else {
        document.getElementById('signupScreen').classList.add('active');
      }
    }

    async function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      const button = document.getElementById('loginButton');
      const errorDiv = document.getElementById('loginError');

      errorDiv.classList.remove('show');
      button.disabled = true;
      button.innerHTML = '<span class="loading-spinner"></span>';

      // Simulate auth delay
      await new Promise(resolve => setTimeout(resolve, 800));

      if (email && password.length >= 6) {
        currentUser = { email, name: email.split('@')[0] };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(currentUser));
        showMainApp();
      } else {
        errorDiv.textContent = 'Invalid credentials. Please try again.';
        errorDiv.classList.add('show');
        button.disabled = false;
        button.textContent = 'Sign In';
      }
    }

    async function handleSignup(e) {
      e.preventDefault();
      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      const button = document.getElementById('signupButton');
      const errorDiv = document.getElementById('signupError');

      errorDiv.classList.remove('show');
      button.disabled = true;
      button.innerHTML = '<span class="loading-spinner"></span>';

      if (window.dataSdk) {
        const result = await window.dataSdk.create({
          user_email: email,
          user_name: name,
          signup_date: new Date().toISOString()
        });

        if (result.isOk) {
          currentUser = { email, name };
          localStorage.setItem(STORAGE_KEY, JSON.stringify(currentUser));
          showMainApp();
        } else {
          errorDiv.textContent = 'Error creating account. Please try again.';
          errorDiv.classList.add('show');
          button.disabled = false;
          button.textContent = 'Create Account';
        }
      } else {
        // Fallback without SDK
        await new Promise(resolve => setTimeout(resolve, 800));
        currentUser = { email, name };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(currentUser));
        showMainApp();
      }
    }

    function handleLogout() {
      currentUser = null;
      localStorage.removeItem(STORAGE_KEY);
      document.getElementById('mainApp').classList.remove('active');
      showScreen('login');
      document.getElementById('loginForm').reset();
    }

    function showMainApp() {
      document.querySelectorAll('.auth-screen').forEach(s => s.classList.remove('active'));
      document.getElementById('mainApp').classList.add('active');
      updateUserProfile();
      showHome();
    }

    function updateUserProfile() {
      if (currentUser) {
        const initial = currentUser.name.charAt(0).toUpperCase();
        document.getElementById('userAvatar').textContent = initial;
        document.getElementById('userName').textContent = currentUser.name;
      }
    }

    function renderRacesCarousel() {
      const track = document.getElementById('carouselTrack');
      track.innerHTML = racesData.map(race => `
        <div class="race-card" onclick="showRaceDetail(${race.id})">
          <div class="race-image">${race.icon}</div>
          <div class="race-content">
            <div class="race-date">${race.date}</div>
            <div class="race-title">${race.title}</div>
            <div class="race-location">üìç ${race.location}</div>
          </div>
        </div>
      `).join('');
    }

    function renderNews() {
      const grid = document.getElementById('newsGrid');
      grid.innerHTML = newsData.map(news => `
        <div class="news-card" onclick="showNewsDetail(${news.id})">
          <div class="news-image">${news.icon}</div>
          <div class="news-content">
            <div class="news-category">${news.category}</div>
            <div class="news-title">${news.title}</div>
            <div class="news-excerpt">${news.excerpt}</div>
            <div class="news-footer">
              <span>${news.date}</span>
              <span>‚Üí</span>
            </div>
          </div>
        </div>
      `).join('');
    }

    function scrollCarousel(direction) {
      const wrapper = document.getElementById('carouselWrapper');
      const scrollAmount = 300;
      if (direction === 'prev') {
        wrapper.scrollLeft -= scrollAmount;
      } else {
        wrapper.scrollLeft += scrollAmount;
      }
    }

    function showRaceDetail(id) {
      const race = racesData.find(r => r.id === id);
      if (!race) return;

      currentDetailId = id;
      currentDetailType = 'race';

      const ctaPrimary = window.elementSdk?.config?.cta_primary || defaultConfig.cta_primary;
      const ctaSecondary = window.elementSdk?.config?.cta_secondary || defaultConfig.cta_secondary;

      document.getElementById('detailHeaderTitle').textContent = race.title;
      document.getElementById('detailContent').innerHTML = `
        <div class="detail-hero">${race.icon}</div>
        <div class="detail-meta">
          <div class="meta-item">
            <span class="meta-icon">üìÖ</span>
            <div>
              <div class="meta-text">Fecha</div>
              <div class="meta-value">${race.date}</div>
            </div>
          </div>
          <div class="meta-item">
            <span class="meta-icon">üìç</span>
            <div>
              <div class="meta-text">Ubicaci√≥n</div>
              <div class="meta-value">${race.location}</div>
            </div>
          </div>
          <div class="meta-item">
            <span class="meta-icon">üèÅ</span>
            <div>
              <div class="meta-text">Duraci√≥n</div>
              <div class="meta-value">${race.stage}</div>
            </div>
          </div>
        </div>
        <div class="detail-description">
          <h3>About This Race</h3>
          <p>Experience the excitement of professional cycling in one of the most prestigious races on the calendar. We bring you to witness every stage, every climb, every final sprint. Our packages include everything you need to enjoy worry-free: flights, accommodation, transportation, and access to the best viewing areas.</p>
          <p>This is your opportunity to become part of cycling history. You won't just watch the race, you'll live it with the passion of a true cycling enthusiast.</p>
        </div>
        <div class="cta-section">
          <div class="cta-title">${ctaPrimary}</div>
          <div class="cta-subtitle">Discover our exclusive tour packages</div>
          <div class="cta-buttons">
            <button class="btn-cta" onclick="showPackages()">${ctaSecondary}</button>
            <button class="btn-cta-secondary" onclick="showPackages()">View Packages</button>
          </div>
        </div>
      `;

      document.getElementById('homeView').style.display = 'none';
      document.getElementById('detailView').classList.add('active');
    }

    function showNewsDetail(id) {
      const news = newsData.find(n => n.id === id);
      if (!news) return;

      currentDetailId = id;
      currentDetailType = 'news';

      const ctaPrimary = window.elementSdk?.config?.cta_primary || defaultConfig.cta_primary;
      const ctaSecondary = window.elementSdk?.config?.cta_secondary || defaultConfig.cta_secondary;

      document.getElementById('detailHeaderTitle').textContent = news.title;
      document.getElementById('detailContent').innerHTML = `
        <div class="detail-hero">${news.icon}</div>
        <div class="detail-meta">
          <div class="meta-item">
            <span class="meta-icon">üè∑Ô∏è</span>
            <div>
              <div class="meta-text">Categor√≠a</div>
              <div class="meta-value">${news.category}</div>
            </div>
          </div>
          <div class="meta-item">
            <span class="meta-icon">üìÖ</span>
            <div>
              <div class="meta-text">Publicado</div>
              <div class="meta-value">${news.date}</div>
            </div>
          </div>
        </div>
        <div class="detail-description">
          <h3>Full Article</h3>
          <p>${news.excerpt}</p>
          <p>This is a historic moment for professional cycling. The presence of world-class athletes at the Tour de France demonstrates the growth and passion for this sport worldwide. Every pedal stroke, every kilometer ridden, is another step toward sporting excellence.</p>
          <p>Join us on this adventure. Whether as a live spectator or following special coverage, be part of this community that celebrates effort, dedication, and the sporting spirit.</p>
        </div>
        <div class="cta-section">
          <div class="cta-title">Ready for the Adventure?</div>
          <div class="cta-subtitle">Transform your passion for cycling into an unforgettable experience</div>
          <div class="cta-buttons">
            <button class="btn-cta" onclick="showPackages()">${ctaPrimary}</button>
            <button class="btn-cta-secondary" onclick="showPackages()">${ctaSecondary}</button>
          </div>
        </div>
      `;

      document.getElementById('homeView').style.display = 'none';
      document.getElementById('detailView').classList.add('active');
    }

    function showPackages() {
      document.getElementById('detailHeaderTitle').textContent = 'Paquetes Disponibles';
      document.getElementById('detailContent').innerHTML = `
        <div class="detail-description">
          <h3>Elige tu Experiencia</h3>
          <p>Hemos dise√±ado tres paquetes especiales para que vivas el Tour de France desde M√©xico. Cada uno incluye vuelos, hospedaje, transporte y acceso a las carreras. Solo tienes que elegir el que mejor se adapte a ti.</p>
        </div>
        <div class="packages-grid">
          ${packagesData.map(pkg => `
            <div class="package-card">
              <div class="package-badge">${pkg.badge}</div>
              <div class="package-body">
                <div class="package-name">${pkg.name}</div>
                <div class="package-price">${pkg.price}</div>
                <div class="package-price-note">${pkg.note}</div>
                <ul class="package-features">
                  ${pkg.features.map(f => `<li><span class="feature-icon">ÔøΩÔøΩÔøΩ</span> ${f}</li>`).join('')}
                </ul>
                <button class="btn-package" onclick="selectPackage(${pkg.id})">Reservar Ahora</button>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function selectPackage(id) {
      const pkg = packagesData.find(p => p.id === id);
      if (pkg) {
        const message = `You've selected the ${pkg.name} package! In a real application, your booking would be processed here.`;
        document.getElementById('detailContent').insertAdjacentHTML('afterbegin', `
          <div style="background: rgba(199, 182, 120, 0.2); border: 2px solid #C7B678; border-radius: 16px; padding: 20px; margin-bottom: 20px; text-align: center;">
            <div style="font-size: 48px; margin-bottom: 10px;">‚úì</div>
            <div style="font-size: 20px; font-weight: 700; color: #C7B678; margin-bottom: 10px;">${message}</div>
            <div style="color: #a0a0a0; font-size: 14px;">Our team will contact you soon.</div>
          </div>
        `);
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    function showHome() {
      document.getElementById('detailView').classList.remove('active');
      document.getElementById('homeView').style.display = 'block';
      currentDetailId = null;
      currentDetailType = null;
    }

    window.showRaceDetail = showRaceDetail;
    window.showNewsDetail = showNewsDetail;
    window.showPackages = showPackages;
    window.selectPackage = selectPackage;
    window.handleSearchResultClick = handleSearchResultClick;

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a4c891370c36be4',t:'MTc2NDE5MzEzNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

